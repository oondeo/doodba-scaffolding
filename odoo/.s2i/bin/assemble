#!/bin/bash

set -e

shopt -s dotglob
echo "---> Installing application source ..."
# find /tmp
cp -a /tmp/src/odoo/custom/* "/opt/odoo/custom"
# find /opt/odoo

# /opt/odoo/common/build && sync
if [ "$AGGREGATE" = true ]; then
    autoaggregate
fi

# /opt/maintainer-quality-tools/travis/clone_oca_dependencies /opt/odoo/custom/src /opt/odoo/custom/src

#for requirements.txt in /opt/odoo: pip install --user -r requirements.txt

if [ "$COMPILE" = true ]; then
    log INFO Compiling all Python code in /opt/odoo
    python -m compileall -q /opt/odoo
fi


rm -rf /opt/odoo/auto/*
mkdir -p /opt/odoo/auto/addons
